# enable focus events to allow vim to detect when focus is gained and refresh its xserver connection (important for clipboard sync)
set-option -g focus-events on

# Don't want to wait too long on esc press, or it will seem unresponsive in vim
set-option -sg escape-time 10

# Increase tmux messages display duration from 750ms to 4s
set -g display-time 4000

set-option -sa terminal-features ',screen-256color:RGB'
# Set a default terminal. Prefer tmux-256color if terminfo is installed.
# Use screen-256color as a fallback if tmux-256color is unavailable.
set-option -sg default-terminal tmux-256color
set-option -g default-shell /bin/zsh

# Allow mouse clicks to select panes
set-option -g mouse on

# Improve history search usability
set-option -g history-limit 100000
set-option -g mode-keys vi

# Highlight focused pane using terminal default colors
set-option -g window-style 'bg=colour42,fg=default'
set-option -g window-active-style 'bg=colour40,fg=default'
set-option -g pane-border-style 'bg=colour42,fg=brightblack'
set-option -g pane-active-border-style 'fg=default'

# Vim-style selection in copy-mode
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-selection-and-cancel



# Incremental search in copy-mode (live results)
bind-key -T copy-mode-vi / command-prompt -i -p "Search forward:" "send -X search-forward-incremental '%%'"
bind-key -T copy-mode-vi ? command-prompt -i -p "Search backward:" "send -X search-backward-incremental '%%'"

# Copy-mode and search highlight colors
set-option -g mode-style 'bg=colour21,fg=default'
set-option -g copy-mode-match-style 'bg=colour29,fg=default'
set-option -g copy-mode-current-match-style 'bg=colour23,fg=default'
set-option -g message-style 'bg=colour36,fg=default'

# Prefix search: enter copy-mode and start incremental search
bind-key / copy-mode \; command-prompt -i -p "Search forward:" "send -X search-forward-incremental '%%'"
bind-key ? copy-mode \; command-prompt -i -p "Search backward:" "send -X search-backward-incremental '%%'"

# Only confirm pane close when something other than a shell is running
bind-key x if-shell -F '#{||:#{m:*zsh,#{pane_current_command}},#{||:#{m:*bash,#{pane_current_command}},#{m:*fish,#{pane_current_command}}}}' 'kill-pane' 'confirm-before -p "kill-pane? (y/n)" kill-pane'

# Prefix + hjkl pane navigation
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# Display current mode in the status bar
set-option -g status-right "#{?client_prefix, PREFIasdfX,} #{?pane_in_mode,[COPY],}"
set-option -g status off
bind t set-option status
set -g status-bg colour27
set -g status-fg colour45



bind m display-menu -T "#[align=centre]Select Mode" \
    "Copy Mode" c "copy-mode" \
    "Sync Panes" s "set-window-option synchronize-panes" \
    "Exit" q ""








